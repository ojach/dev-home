<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>OJapp Builder</title>
<style>
/* ------- æ—¢å­˜ãƒ‡ã‚¶ã‚¤ãƒ³ãã®ã¾ã¾ ------- */
body{ margin:0;font-family:"Helvetica","Arial","YuGothic",sans-serif;background:#ffffff;color:#222;}
.header{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #eee;}
.logo{display:flex;align-items:center;font-size:22px;font-weight:bold;gap:6px;}
.logo-icon{width:34px;height:34px;background:radial-gradient(circle at 30% 30%, #6dd4ff, #2bb7ff);border-radius:50%;position:relative;}
.logo-icon::after{content:"";position:absolute;width:13px;height:13px;background:radial-gradient(circle at 30% 30%, #ffb0d8, #ff4fa9);border-radius:50%;top:9px;left:10px;}
.switch{font-size:24px;cursor:pointer;}
h2{text-align:center;margin-top:30px;font-weight:600;}
.btn{display:inline-block;margin:25px auto;padding:18px 38px;background:linear-gradient(#ffd85a,#ffb726);border-radius:40px;font-weight:bold;font-size:20px;text-align:center;box-shadow:0 6px 0 #d19400;transition:0.2s;position:relative;}
.btn::after{content:"";position:absolute;top:6px;left:50%;transform:translateX(-50%);width:70%;height:30%;border-radius:30px;background:rgba(255,255,255,0.55);filter:blur(2px);}
.btn:hover{transform:scale(1.06);}
.btn:active{transform:scale(0.97);box-shadow:0 3px 0 #a87500;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.04);}100%{transform:scale(1);}}
.btn.pulse{animation:pulse 2.4s infinite ease-in-out;}
.arrow{text-align:center;font-size:26px;animation:float 1.6s infinite ease-in-out;}
@keyframes float{0%{transform:translateY(0);}50%{transform:translateY(8px);}100%{transform:translateY(0);}}
.section{width:90%;max-width:500px;background:white;margin:18px auto;padding:20px;border-radius:18px;box-shadow:0 0 12px rgba(0,0,0,0.05);}
.section-title{font-size:18px;margin-bottom:10px;font-weight:bold;}
input[type=file],input[type=text]{width:100%;padding:13px;border-radius:12px;border:1px solid #ddd;font-size:16px;outline:none;}
input:focus{border-color:#66c8ff;}
.icon-box{width:160px;height:160px;background:#f5f5f5;border-radius:22px;margin:12px auto;display:flex;justify-content:center;align-items:center;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.06);}
.icon-box img{width:100%;height:100%;object-fit:cover;border-radius:22px;}
#assistantBox{position:fixed;bottom:20px;right:20px;background:white;border-radius:20px;border:2px solid #2bb7ff;padding:12px 18px;box-shadow:0 0 12px rgba(0,0,0,0.1);font-size:15px;display:none;}
</style>
</head>
<body>

<div class="header">
 <div class="logo"><div class="logo-icon"></div>OJapp</div>
 <div class="switch" onclick="toggleA()">ğŸ˜†</div>
</div>

<h2>ãƒ›ãƒ¼ãƒ ã‚’å¤‰ãˆã‚‹ã€‚è‡ªåˆ†ã‚’å¤‰ãˆã‚‹ã€‚</h2>

<div style="text-align:center;">
 <div class="btn pulse" onclick="generateApp()">Create App ğŸ‰</div>
 <div class="arrow">â–¼</div>
</div>

<div class="section">
 <div class="section-title">Step1ï¼šã‚¢ã‚¤ã‚³ãƒ³ç”»åƒ</div>
 <input type="file" id="iconInput">
 <div class="icon-box"><img id="preview" /></div>
</div>

<div class="section">
 <div class="section-title">Step2ï¼šã‚¢ãƒ—ãƒªå</div>
 <input type="text" id="appName" placeholder="OJACH PORTAL">
</div>

<div class="section">
 <div class="section-title">Step3ï¼šURL</div>
 <input type="text" id="targetURL" placeholder="https://example.com">
</div>

<div id="assistantBox">ãŠã¡ã‚ƒã˜å‚ä¸ŠğŸ˜âœ¨</div>

<script>
function toggleA(){
 let box=document.getElementById("assistantBox");
 box.style.display=(box.style.display=="none")?"block":"none";
}

// ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
document.getElementById("iconInput").addEventListener("change",e=>{
 const file=e.target.files[0];
 if(file) document.getElementById("preview").src=URL.createObjectURL(file);
});

/*====================
   ğŸ”¥ Appç”Ÿæˆãƒ¡ã‚¤ãƒ³
====================*/
function generateApp(){
 const iconFile = document.getElementById("iconInput").files[0];
 const name     = document.getElementById("appName").value || "MyApp";
 const url      = document.getElementById("targetURL").value || "";

 if(!iconFile) return alert("ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„ï¼");
 if(!url)      return alert("URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");

 // â–¼ ã‚¢ã‚¤ã‚³ãƒ³ã‚’Base64åŒ– â†’ HTMLã«åŸ‹ã‚è¾¼ã‚€
 const reader = new FileReader();
 reader.onload = function(e){

 let iconBase64 = e.target.result;

 // â–¼ ç”Ÿæˆã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸
 let html = `
<!DOCTYPE html><html><head>
<meta charset="UTF-8">
<title>${name}</title>
<link rel="apple-touch-icon" href="${iconBase64}">
<style>
body{margin:0;display:flex;justify-content:center;align-items:center;height:100vh;background:#e6f6ff;font-family:-apple-system;}
#logo{background:white;padding:22px 30px;border-radius:22px;font-size:30px;font-weight:bold;color:#ff69b4;box-shadow:0 4px 10px rgba(0,0,0,.25);animation:pulse 1.2s infinite;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.07);}100%{transform:scale(1);}}
.msg{position:absolute;bottom:25px;width:100%;text-align:center;color:#555;}
</style>
</head><body>

<div id="logo">${name}</div>
<div class="msg">åˆå›ã¯30ç§’å¾Œã«è‡ªå‹•é·ç§»ã—ã¾ã™<br>ãƒ›ãƒ¼ãƒ è¿½åŠ æ¨å¥¨ğŸ”¥</div>

<script>
let first = !localStorage.getItem("${name}_installed");
let sec = first ? 30 : 3;
localStorage.setItem("${name}_installed","yes");

let timer=setInterval(()=>{
 sec--;
 if(sec<=0){
  clearInterval(timer);
  location.href="${url}";
 }
},1000);
<\/script>
</body></html>`;

 // â–¼ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é–‹ã
 const blob = new Blob([html],{type:"text/html"});
 const blobURL = URL.createObjectURL(blob);
 window.open(blobURL,"_blank");

 alert("ç”Ÿæˆãƒšãƒ¼ã‚¸ãŒé–‹ãã¾ã—ãŸï¼ãƒ›ãƒ¼ãƒ ã«è¿½åŠ ã—ã¦ã¿ã¦ğŸ”¥");
 }
 reader.readAsDataURL(iconFile);
}
</script>
</body>
</html>

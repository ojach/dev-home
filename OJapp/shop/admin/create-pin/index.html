<!-- ã™ã¹ã¦ã®ãƒšãƒ¼ã‚¸ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ãƒ•ãƒƒã‚¿ãƒ¼ã®ã‚³ãƒ”ãƒšç”¨ -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <!-- ã“ã“ã« head-template.html ã‚’ã‚³ãƒ”ãƒš -->
  <!-- â–¼ OJapp å…±é€š HEADï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰ -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>OJapp</title>

<!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ -->
<link rel="icon" type="image/png" sizes="16x16" href="/OJapp/icon/favicon-16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/OJapp/icon/favicon-32.png">
<link rel="icon" type="image/png" sizes="48x48" href="/OJapp/icon/favicon-48.png">

<!-- iPhone ãƒ›ãƒ¼ãƒ ã‚¢ã‚¤ã‚³ãƒ³ -->
<link rel="apple-touch-icon" sizes="180x180" href="/OJapp/icon/icon-180.png">

<!-- PWAï¼ˆå¿…è¦ãªã‚‰æœ‰åŠ¹åŒ–ï¼‰ -->
<!-- <link rel="manifest" href="/OJapp/manifest.json"> -->

<meta name="theme-color" content="#2bb7ff">

<!-- å…±é€šCSS -->
<link rel="stylesheet" href="/OJapp/style.css">
<!-- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å‘¼ã¶ -->
<script src="/OJapp/darkmode.js"></script>
</head>

<body>

<div id="header"></div>
<script>
fetch("/OJapp/header.html")
  .then(r => r.text())
  .then(h => document.getElementById("header").innerHTML = h);
</script>

<main style="max-width:600px;margin:40px auto;padding:20px;
             background:#fff;border-radius:16px;
             box-shadow:0 4px 14px rgba(0,0,0,0.12);
             font-family:sans-serif;">

  <h2 style="margin-bottom:16px;font-size:22px;font-weight:bold;">
    ğŸ” PIN ç™ºè¡Œãƒ„ãƒ¼ãƒ«ï¼ˆç®¡ç†è€…å°‚ç”¨ï¼‰
  </h2>

  <p style="opacity:.7;margin-bottom:20px;font-size:14px;">
    ä½œè€…åã‚’å…¥åŠ› â†’ PINç”Ÿæˆ â†’ Discordã§ä½œè€…ã¸æ¸¡ã™ã ã‘ã€‚
    <br>â€»PINå†ç™ºè¡Œã™ã‚‹ã¨éå»PINã¯ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚
  </p>

  <label style="font-weight:600;">ä½œè€…å</label>
  <input id="author" placeholder="ä¾‹ï¼šojach"
         style="width:100%;padding:12px;font-size:16px;
                border-radius:10px;border:1px solid #ddd;
                margin:8px 0 20px 0;">

  <button onclick="createPIN()"
          style="width:100%;padding:14px;font-size:16px;
                 background:#0f9cf5;color:#fff;
                 border:none;border-radius:12px;
                 font-weight:bold;cursor:pointer;">
    PINã‚’ç”Ÿæˆã™ã‚‹
  </button>

  <pre id="result"
       style="margin-top:24px;padding:16px;background:#f5f5f5;
              border-radius:12px;white-space:pre-wrap;
              min-height:80px;font-size:15px;"></pre>
</main>

<script>
const API = "https://ojshop-fav.trc-wasps.workers.dev";

async function createPIN() {
  const name = document.getElementById("author").value.trim();
  const box = document.getElementById("result");

  if (!name) {
    box.textContent = "âŒ ä½œè€…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
    return;
  }

  box.textContent = "â³ PINç”Ÿæˆä¸­â€¦";

  const res = await fetch(`${API}/shop/admin/create-pin?name=` + encodeURIComponent(name), {
    method: "POST"
  });

  const data = await res.json();

  if (!data.ok) {
    box.textContent = "âŒ ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
    return;
  }

  box.textContent =
    "âœ… PIN ç™ºè¡Œã«æˆåŠŸï¼\n\n" +
    `ä½œè€…åï¼š ${data.author}\n` +
    `PINï¼š ${data.pin}\n\n` +
    `ğŸ”“ ãƒ­ã‚°ã‚¤ãƒ³ã‚­ãƒ¼ï¼š ${data.author}${data.pin}\n\n` +
    "â€»ä½œè€…ã¸ã“ã®ãƒ­ã‚°ã‚¤ãƒ³ã‚­ãƒ¼ã‚’æ¸¡ã—ã¦ãã ã•ã„ã€‚";
}
</script>

<div id="footer"></div>
<script>
fetch("/OJapp/footer.html")
  .then(r => r.text())
  .then(h => document.getElementById("footer").innerHTML = h);
</script>

</body>
</html>
